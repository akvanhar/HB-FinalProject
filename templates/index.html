{% extends 'base.html' %}
{% block content %}
<script>
	    $("#homeButton").attr("class", 'active');
</script>

{% for message in get_flashed_messages() %}
	{{message}}
{% endfor %}

	{% if 'user_id' not in session %}
		<h3>Don't forget to login before posting or checking out the Make Less Mush listings!</h3>
	{% endif %}
	<div class="row">
		<div class="container">
			<div id="formCol" class="col-sm-5" style="margin-right: 1">
				<h3>Share some mush:</h3>
				<form class="form-horizontal" action='/postlisting' method='post'>
					<div class="row">
						<div class="form-group form-group-lg">
							<label class="col-sm-3 control-label" for="foodTitle">Title: </label>
					    		<div class="col-sm-9">
					      			<input class="form-control" type="text" id="foodTitle" placeholder="Your recipe title" name='title'>
					    		</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group form-group-md">
							<label class="col-sm-3 control-label" for="texture">Texture: </label>
					    		<div class="col-sm-9">
					      			<select class="form-control" id="texture" name='texture'>
										<option class="form-control" value='smooth_puree'>Smooth puree
										<option class="form-control" value='lumpy_puree'>Lumpy puree
										<option class="form-control" value='diced'>Diced
									</select>
					    		</div>
				    		</label>
						</div>
					</div>
					<div class="row">
						<div class="form-group form-group-md">
							<label class="col-sm-3 control-label" for="datemade">Date made: </label>
					    		<div class="col-sm-9">
					      			<input class="form-control" id="datemade" type='date' name='datemade' value='{{ current_date }}'>
					    		</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group form-group-md">
							<label class="col-sm-3 control-label" for="quantity">Quantity (oz): </label>
					    		<div class="col-sm-9">
					      			<input class="form-control" type='number' min='0' name='quantity' placeholder='8 oz.'>
					    		</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group form-group-md">
							<label class="col-sm-3 control-label">Fresh or Frozen:</label>
							<label class="col-sm-3 control-label" for="freshfrozen">Fresh </label>
								<input class="col-sm-1 radio-inline" type="radio" name="freshfrozen" value="fresh">
							<label class="col-sm-3 control-label" for="freshfrozen">Frozen </label>
								<input class="col-sm-1 radio-inline" type="radio" name="freshfrozen" value="frozen">
							<div class="col-sm-1"></div>
						</div>
					</div>
					<div class="form-group form-group-md">
						<div class="row">
							<label class="control-label col-sm-3">Allergens:</label>
								
								<div class="col-sm-2">
									<label class="checkbox-inline">
										<input type='checkbox' name='allergens' value='eggs'>
									Eggs</label>
								</div>
								<div class="col-sm-2">
									<label class="checkbox-inline">
										<input type='checkbox' name='allergens' value='dairy'>
									Dairy</label>
								</div>
								<div class="col-sm-2">
									<label class="checkbox-inline">
										<input type='checkbox' name='allergens' value='fish'>
									Fish</label>
								</div>
								<div class="col-sm-2">
									<label class="checkbox-inline">
										<input type='checkbox' name='allergens' value='peanuts'>
									Peanuts</label>	
								</div>
							<div class="col-sm-1"></div>
						</div>
						<div class="row">
							<div class="col-sm-3"></div>
							<div class="col-sm-2">
								<label class="checkbox-inline">
									<input type='checkbox' name='allergens' value='soy'>
									Soy</label>
							</div>
							<div class="col-sm-2">
								<label class="checkbox-inline">
									<input type='checkbox' name='allergens' value='treenuts'>
								Tree-nuts</label>
							</div>
							<div class="col-sm-2">
								<label class="checkbox-inline">
									<input class="col-sm-1" type='checkbox' name='allergens' value='wheat'>
								Wheat</label>
							</div>
							<div class="col-sm-2">
								<label class="checkbox-inline col-sm-1">
									<input class="col-sm-1" type='checkbox' name='allergens' value='shellfish'>
								Shellfish</label>
							</div>
							<div class="col-sm-1"></div>
						</div>
					</div>
					<div class="form-group form-group-md">
						<div class="row">
								<label class="col-sm-3">Description:</label>
									<textarea class="form-control col-sm-9" name='description' rows='5' placeholder='Please include ingredients, what you would like to swap for, and your preferred method of contact'></textarea>
								
						</div>
					</div>
					<div class="form-group">
						<input class="col-sm-2 col-sm-offset-10 btn btn-default" type='submit' value='create listing'>
					</div>
				</form>
			</div>
			<div id="listingsCol "class="col-sm-7">
				<div class="row">
					<h3 class="col-sm-12">Get some mush:</h3>
				</div>
				<table class="table table-condensed table-hover">
					<div class="row">
						<thead>
							<tr>
								<th class="col-sm-2">Date posted</th>
								<th class="col-sm-2">Title</th>
								<th class="col-sm-5">Description</th>
								<th class="col-sm-3">Made by</th>
							</tr>
						</thead>
					</div>
					<tbody>
						{% for food in user_listings %}
							<div class="row">
								<tr>
									<td class="col-sm-2">{{ food.post_date.strftime("%b %d, %Y") }}</td>
									<td class="col-sm-2"><a href="/listings/{{ food.food_id }}">
					                    {{ food.title }}
					                	</a>
					                </td>
									<td class="col-sm-5">{{ food.description }}</td>
									<td class="col-sm-3"><a href='/user/{{ food.user_id }}'>{{ food.user.fname }}  <img class="img-circle" src="//graph.facebook.com/{{ food.user.fb_id }}/picture" alt="Facebook profile picture"></td></a>
								</tr>
							</div>
						{% endfor %}
					</tbody>
				</table>
				<div class="row">
					<a href='/listings'><button class="col-sm-2 col-sm-offset-10 btn btn-default">View all</button></a>
				</div>

				<div class="row">
					<div class="col-sm-1"></div>
					<h4 class="col-sm-11">Your facebook friends on Make Less Mush:</h4>
					{% if friends_fb_ids %}
					{% for friend in friends_fb_ids %}
						<div class="col-sm-1"></div>
						<div class="col-sm-1"><a href='/user/{{friend[0]}}'><img class="thumbnail" src="//graph.facebook.com/{{friend[1]}}/picture" alt="Facebook profile picture"></a></div>
					{% endfor %}
					{% else %}
						<div class="col-sm-1"></div><p class="col-sm-11">Sorry! None of your FaceBook friends have signed up for Make Less Mush yet! Why don't you tell them about it?</p>
						<div class="col-sm-1"></div><button class="btn btn-default col-sm-6">Share Make Less Mush on FaceBook</button>
					{% endif %}
				</div> <!-- end row -->
			</div> <!-- end recent listings table -->
		</div>
	</div>
{% endblock %}
